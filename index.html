<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handlevogn</title>
    <link rel="stylesheet" href="style.css"/>
    
</head>
<body>
    <div id="app"></div>

    <script>
        const app = document.getElementById('app');
        
        var store = [
        {
            item: 'Milk',
            price: 30,
            stock: 15,
            image: 'img/milk.png',
            cart: 0,
        },
        {
            item: 'Cereal',
            price: 20,
            stock: 10,
            image: 'img/cereal.png',
            cart: 0,
        },{
            item: 'Chocolate',
            price: 40,
            stock: 8,
            image: 'img/chocolate.png',
            cart: 0,
        },{
            item: 'Friend',
            price: 10000,
            stock: 0,
            image: 'img/friend.png',
            cart: 0,
        }, ]
        var shoppingCart = []
        let sumtotal = 0
        var itemincart = false

        updateview()
        function updateview(){
            app.innerHTML = /*HTML*/`

            <div class="page">
            <h1 class="header">OKMart</h1>

            <div class="store">
                ${createstore()}
                </div>

            <div class="shoppingCart">
                <h2 class="cartheader">Shopping Cart</h2>
                    ${updateCart()}
                    <div class="sumtotal">Totalt Ã¥ betale: ${sumtotal} kr</div>
           </div>
                
            
            </div>
            `;
        }

        function createstore(){
            let html = ''
            for( let i = 0; i < store.length; i++){
                html +=     `<div class="itemcontainer">
                                <div>${store[i].item}</div>
                                <img class="itemimage" src="${store[i].image}">            
                                <div>${store[i].price} kr</div>
                                <div>${store[i].stock} left in stock</div>
                                <button class="addToCart" onclick="addToCart(${i})">Add to cart</button>
                                </div>
                                `;
            }
            return html
        }

        function addToCart(i){
            if(store[i].stock > 0){
                
                    if(0 < store[i].cart){
                        itemincart = true
                    }
                
                    if(itemincart == false){
                        shoppingCart.push(store[i]);
                        store[i].stock --
                        store[i].cart ++
                        sumtotal = sumtotal + store[i].price;
                    }
                    else if(itemincart== true){
                        
                        store[i].stock --
                        store[i].cart ++
                        sumtotal = sumtotal + store[i].price;
                    }
                    itemincart = false

                }
                else{
                    alert('Item out of stock')
                }
                
            updateview()
        }

         function updateCart(){  
            let itemsincart ="";
            if(shoppingCart.length <= 0){
                itemsincart = "Empty Cart, buy somth"
            }
            else{
                for(let i = 0; i < shoppingCart.length; i++){
                    itemsincart += `<div class="cartitem"><div>${shoppingCart[i].cart}x   ${shoppingCart[i].item}</div>
                    <img class="cartimage "src="${shoppingCart[i].image}"></div>`;
                    }
            }
            
             return itemsincart
        }
    </script>

</body>
</html>